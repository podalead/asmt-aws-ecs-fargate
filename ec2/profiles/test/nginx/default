upstream testerizator {
    server {{ app_ip }}:8080;
}

server {
        server_name testerization.cf *.testerization.cf;
        listen      80;
        return      301  https://$server_name$request_uri;
}

server {
        server_name testerization.cf *.testerization.cf;
        listen      443 ssl;

        error_log  /var/log/nginx/app.error.log;
        access_log /var/log/nginx/app.access.log timed_combined;

        location / {
                proxy_set_header  Host $host;
                proxy_set_header  X-Real-IP $remote_addr;
                proxy_set_header  X-Forwarded-Proto https;
                proxy_set_header  X-Forwarded-For $remote_addr;

                proxy_pass         http://testerizator;
                proxy_http_version 1.1;
                proxy_set_header   Upgrade $http_upgrade;
                proxy_set_header   Connection "upgrade";
                auth_basic off;
        }
}

